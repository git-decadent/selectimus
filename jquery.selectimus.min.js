/*!
 *
 * Selectimus 0.1.0
 * Copyright 2012, Egor Skorobogatov
 * egor.skorobogatov@gmail.com
 *
 * Released under the MIT, BSD, and GPL Licenses
 * https://github.com/git-decadent/selectimus
 *
 * Change of standart selects in browser.
 * 
 * Includes ScrollBarJS.js
 *
*/
(function(f){function r(b,k,e,d){this.selected={};this.parent=f(k);this.div=f("<div>");this.box=f("<div>");var l=this,c=f("<table>"),h=f("<tbody>"),n,g;c.addClass("selectimus-table");n="Opera"==window.navigator.appName?parseInt(b.height)-2*b["border-width"]+"px":b.height;f.each(e,function(a,c){c.value==k.val()&&(l.selected.count=a,l.selected.id=k.val());g=f("<tr>");g.css("height",n);g.html("<td>"+c.innerHTML+"</td>");h.append(g);var d=c.value;g.click(function(){!0==l.opened&&(l.selected.count=a,l.selected.id= d)})});c.append(h);this.content=c;this.button=f("<div>");this.opt={};d=void 0!=d&&void 0!=d.rows?d.rows:s;d=e.length<d?e.length:d;this.opened=!1;for(var j in b)this.div.css(j,b[j]);this.opt.down={height_div:b.height,height_box:"Opera"==window.navigator.appName?parseInt(b.height)-2*parseInt(b["border-width"])+"px":b.height,overflow:"hidden",border:"0 none",zIndex:0};this.opt.up={rows:d,heightContent:e.length*parseInt(b.height)+"px",height_div:d*parseInt(b.height)+"px",height_box:0<=window.navigator.appName.search("Microsoft")? d*parseInt(b.height)-2*parseInt(b.borderWidth)+"px":d*parseInt(b.height)+"px",overflow:"visible",position:"absolute",border:b.border,borderTop:"0 none",zIndex:1E8};this.button.addClass("select-button-close").css({top:(parseInt(b.height)-t)/2+"px"});this.box.addClass("select-box").css({height:this.opt.down.height_box,background:b.background,"border-radius":b["border-radius"]});this.div.addClass("selectimus");this.box.append(this.content);this.div.append(this.button);this.div.append(this.box);var i= function(){a.div.click()},a=this;this.div.toggle(function(){a.opened=!0;a.div.css({borderBottom:a.opt.up.borderTop,borderLeft:a.opt.up.borderTop,borderRight:a.opt.up.borderTop,overflow:a.opt.up.overflow,height:a.opt.up.height_div});a.box.css({position:a.opt.up.position,border:a.opt.up.border,borderTop:a.opt.up.borderTop,height:a.opt.up.height_box,zIndex:a.opt.up.zIndex});a.box.find("TD").eq(a.selected.id).addClass("td_hover");a.box.find("TD").hover(function(){a.box.find("TD").removeClass("td_hover"); f(this).addClass("td_hover")});if(void 0==a.scrollbar){var c=a,d=a.opt,d=d.up.height==d.up.heightContent?!1:f.scrollbar({scrollpane:a.box,scrollcontent:a.content,options:{orientation:"vertical",css:{position:"absolute"}}});c.scrollbar=d}!1!=a.scrollbar?(a.scrollbar.show(),a.scrollbar.move(-1*a.selected.count*parseInt(a.opt.down.height_box),!1)):p.call(a,-1*a.selected.count*parseInt(a.opt.down.height_box));m.bind("click",i)},function(){a.opened=!1;m.unbind("click",i);a.div.css({border:a.opt.up.border, height:a.opt.down.height_div});a.box.css({border:a.opt.down.border,borderTop:a.opt.up.borderTop,height:a.opt.down.height_box,zIndex:a.opt.down.zIndex});!1!=a.scrollbar?(a.scrollbar.move(-1*a.selected.count*parseInt(a.opt.down.height_box),!0),a.scrollbar.hide()):p.call(a,-1*a.selected.count*parseInt(a.opt.down.height_box),!0);a.box.find("TD").unbind();a.box.find("TD").eq(a.selected.count).removeClass("td_hover");a.parent.val(a.selected.id)})}function p(b,f){var e;e=!0==f||Math.abs(b)<this.content.height()- parseInt(this.opt.up.height)?b:0;this.content.css({"margin-top":e+"px"})}var m=f(document),s=10,q={},u=0,t=16;f.fn.selectimus=function(b,k){var e={background:"white",display:"inline-block","border-width":1,"border-style":"solid","border-color":"#b6b6b6","border-radius":"5px",margin:"3px 0",padding:0,position:"relative",overflow:"visible"},d;if(void 0!=b)for(d in b)e[d]=b[d];e.border=e["border-width"]+"px "+e["border-style"]+" "+e["border-color"];f.each(this,function(d,c){var h=f(c);if(void 0==q[h.attr("id")]){var h= f(c),b=h.children(),g={};g.height=h[0].clientHeight;g.width=h[0].clientWidth;for(var j in e)g[j]=e[j];0<=window.navigator.appVersion.search("Safari")&&(g.width=h.outerWidth()-e["border-width"]+"px",g.height=h.outerHeight()-e["border-width"]+"px");if(void 0!=k){j={width:5,height:5};for(var i in k)void 0!=j[i]&&(g[i]=parseInt(g[i])+k[i]*j[i]+"px")}i=new r(g,h,b,k);q[h.attr("id")]=i;u++;h.css("display","none");i.div.insertBefore(h)}});return this};f.scrollbar=function(b){function k(b,c,h){b=b.height(); scrollcontent_h=c.height();scrollbar_wrap_h=b-0.02*b;diff1=scrollcontent_h-b;prop=diff1/scrollcontent_h;scroll_area=scrollbar_wrap_h-2*d.btnsWidth;stopScroll=Math.floor(scroll_area*prop);size_slider=scrollbar_wrap_h-2*d.btnsWidth-stopScroll-2*d.bordersWidth;multiple=diff1/(scrollbar_wrap_h-2*d.btnsWidth-size_slider);multiple=scrollcontent_h/scroll_area;percentContent=diff1/100;percentSlider=stopScroll/100;void 0!=h&&(size_slider=height2,h.height(height2));return{scrollpane_h:b,scrollcontent_h:scrollcontent_h, scrollcontent_stop:b-scrollcontent_h,scrollbar_wrap_h:scrollbar_wrap_h,size_slider:size_slider,multiple:multiple,stopScroll:stopScroll,percentContent:percentContent,percentSlider:percentSlider}}function e(b){var c=this,h;this.scrollpane=b.scrollpane;this.scrollcontent=b.scrollcontent;this.params=k(this.scrollpane,this.scrollcontent);this.scroll_top=f("<div>").addClass("w-srcoll-top w-srcoll-btn").css({width:d.btnsWidth+"px",height:d.btnsWidth+"px",backgroundPosition:+(d.btnsWidth-14)/2+"px "+(d.btnsWidth- 14)/2+"px "});this.scroll_bottom=f("<div>").addClass("w-srcoll-bottom w-srcoll-btn").css({width:d.btnsWidth+"px",height:d.btnsWidth+"px",backgroundPosition:+(d.btnsWidth-14)/2+"px 112%"});this.scrollbar_wrap=f("<div>").addClass("w-srcollbar-wrap").css({height:this.params.scrollbar_wrap_h,width:d.btnsWidth});this.scrollbar=f("<div>").addClass("w-srcollbar").css({height:this.params.scrollbar_wrap_h-2*d.btnsWidth,marginTop:d.btnsWidth+"px",width:d.btnsWidth+"px"});this.slider=f("<div>").addClass("w-slider").css({top:0, width:d.btnsWidth-2+"px",height:this.params.size_slider+"px"}).append("<span style='margin:"+this.params.size_slider/2+"px auto;'></span>");this.scrollbar_wrap.append(this.scroll_top);this.scrollbar_wrap.append(this.scrollbar);this.scrollbar_wrap.append(this.scroll_bottom);this.scrollbar.append(this.slider);this.scrollbar_wrap.appendTo(this.scrollpane);var e=function(){m.unbind("mousemove",g)},g=function(a){if(1>j+a.clientY-i)return c.slider.css({top:0}),c.scrollcontent.css({"margin-top":0}),!1;if(j+ a.clientY-i>c.params.stopScroll-1)return c.slider.css({top:c.params.stopScroll}),c.scrollcontent.css({"margin-top":c.params.scrollcontent_stop+"px"}),!1;c.slider.css({top:j+a.clientY-i+"px"});c.scrollcontent.css({"margin-top":c.params.multiple*-1*(j+a.clientY-i)+"px"})},j,i;c.slider.mousedown(function(a){a.preventDefault();m.bind("mousemove",g);m.one("mouseup",e);j=parseInt(c.slider.css("top"));i=a.clientY});this.scrollbar_wrap.click(function(a){a.stopPropagation()});this.scroll_top.add(this.scroll_bottom).bind({mousedown:function(a){a.stopPropagation(); var b;a.target==c.scroll_top[0]?(b=-1,stop=0):(b=1,stop=c.params.stopScroll);h=setInterval(function(){var a=parseInt(c.slider.css("top"));a==stop?(clearInterval(h),c.slider.css("top",stop+"px")):(c.slider.css("top",a+b+"px"),c.scrollcontent.css("margin-top",-1*c.params.multiple*(a+b)+"px"))},4)},mouseup:function(a){a.stopPropagation();clearInterval(h)}});this.scrollbar.bind("click",function(a){if(a.target!=c.scrollbar[0])return!1;var a=a.pageY,b=c.slider.offset().top,d=parseInt(c.scrollcontent.css("margin-top")), e,f=0,g;a<b?(e=a-b,g=-1*Math.round(2*(c.params.scrollcontent_h/c.params.scrollpane_h))):(e=a-b-c.params.size_slider,g=1*Math.round(2*(c.params.scrollcontent_h/c.params.scrollpane_h)));h=setInterval(function(){if(f+g>=e&&0<g||f+g<=e&&0>g)return clearInterval(h),c.slider.offset({top:b+e}),c.scrollcontent.css("margin-top",d-c.params.multiple*e+"px"),!1;c.slider.offset({top:c.slider.offset().top+g});c.scrollcontent.css("margin-top",parseInt(c.scrollcontent.css("margin-top"))-g*c.params.multiple+"px"); f+=g},1)})}var d={btnsWidth:16,btnsHeight:16,bordersWidth:1};e.prototype.move=function(b,c){var d,e=this.params;d=b<e.scrollpane_h-e.scrollcontent_h?e.scrollpane_h-e.scrollcontent_h:b;e=Math.abs(d)/e.percentContent*e.percentSlider;this.slider.css("top",e+"px");void 0==c?this.scrollcontent.animate({"margin-top":d+"px"},800):this.scrollcontent.css({"margin-top":!0==c?b:d+"px"})};e.prototype.show=function(){this.scrollbar_wrap.css("display","block")};e.prototype.hide=function(){this.scrollbar_wrap.css("display", "none")};e.prototype.renew=function(){k(this.scrollpane,this.scrollcontent,this.slider)};return new e(b)}})(jQuery);
/*!
 *
 * Selectimus 0.1.0
 * Copyright 2012, Egor Skorobogatov
 * egor.skorobogatov@gmail.com
 *
 * Released under the MIT, BSD, and GPL Licenses
 * https://github.com/git-decadent/selectimus
 *
 * Change of standart selects in browser.
 * 
 * Includes ScrollBarJS.js
 *
*/(function(e){function p(e,i){var d;d=!0===i||Math.abs(e)<this.content.height()-parseInt(this.opt.up.height,10)?e:0;this.content.css({"margin-top":d+"px"})}function q(g,i,d,b){this.selected={};this.parent=e(i);this.div=e("<div>");this.box=e("<div>");var k=this,c=e("<ul>"),h;c.addClass("selectimus_ul");e.each(d,function(a,b){b.value==i.val()&&(k.selected.count=a,k.selected.id=i.val());h=e("<li>").attr({value:a}).css("height",g.height).html(b.innerHTML);c.append(h)});c.bind("click",function(a){a=a.target; !0===k.opened&&(k.selected.count=a.getAttribute("value"),k.selected.id=a.innerHTML)});this.content=c;this.button=e("<div>");this.opt={};this.opened=!1;var n,b=void 0!==b&&void 0!==b.rows?b.rows:r,b=d.length<b?d.length:b;for(n in g)this.div.css(n,g[n]);this.opt.down={height:g.height,overflow:"hidden",border:"0 none",zIndex:1};this.opt.up={rows:b,heightContent:d.length*parseInt(g.height,10)+"px",height:b*parseInt(g.height,10)+"px",overflow:"visible",position:"absolute",border:g.border,borderTop:"0 none", zIndex:1E8};this.button.addClass("select-button-close").css({top:(parseInt(g.height,10)-s)/2+"px"});this.box.addClass("select-box").css({height:this.opt.down.height,background:g.background,"border-radius":g["border-radius"]});this.div.addClass("selectimus");this.box.append(this.content);this.div.append(this.button);this.div.append(this.box);var j=function(){a.opened=!1;a.button.show();a.div.css({border:a.opt.up.border,height:a.opt.down.height,zIndex:a.opt.down.zIndex});a.box.css({border:a.opt.down.border, borderTop:a.opt.up.borderTop,height:a.opt.down.height});!1!==a.scrollbar?(a.scrollbar.move(-1*a.selected.count*parseInt(a.opt.down.height,10),!0),a.scrollbar.hide()):p.call(a,-1*a.selected.count*parseInt(a.opt.down.height,10),!0);a.box.find("LI").unbind("mouseenter");a.box.find("LI").removeClass("sel_hover");a.parent.val(a.selected.id);a.div.one("click",f)},f=function(c){for(var b in l)!0===l[b].opened&&l[b].div.click();c.stopPropagation();a.opened=!0;a.button.hide();a.div.css({borderBottom:a.opt.up.borderTop, borderLeft:a.opt.up.borderTop,borderRight:a.opt.up.borderTop,overflow:a.opt.up.overflow,height:a.opt.up.height,zIndex:a.opt.up.zIndex});a.box.css({position:a.opt.up.position,border:a.opt.up.border,borderTop:a.opt.up.borderTop,height:a.opt.up.height});a.box.find("LI").eq(a.selected.id).addClass("sel_hover");a.box.find("LI").bind("mouseenter",function(){a.box.find("LI").removeClass("sel_hover");e(this).addClass("sel_hover")});void 0===a.scrollbar&&(c=a,b=a.opt,b=b.up.height_box==b.up.heightContent? !1:e.scrollbar({scrollpane:a.box,scrollcontent:a.content,options:{orientation:"vertical",css:{position:"absolute"}}}),c.scrollbar=b);!1!==a.scrollbar?(a.scrollbar.show(),a.scrollbar.move(-1*a.selected.count*parseInt(a.opt.down.height,10),!1)):p.call(a,-1*a.selected.count*parseInt(a.opt.down.height,10));m.one("click",j)},a=this;this.div.one("click",f)}var m=e(document),r=10,l={},s=16;e.fn.selectimus=function(g,i){var d={background:"white",display:"inline-block","border-width":1,"border-style":"solid", "border-color":"#b6b6b6","border-radius":"5px",margin:"3px 0",padding:0,position:"relative",overflow:"visible"},b;if(void 0!==g)for(b in g)d[b]=g[b];d.border=d["border-width"]+"px "+d["border-style"]+" "+d["border-color"];e.each(this,function(b,c){var h=e(c);if(void 0===l[h.attr("id")]){var h=e(c),g=h.children(),j,f={};f.height=void 0!=d.height?parseInt(d.height,10):22<=h[0].clientHeight?h[0].clientHeight:22;f.width=h[0].clientWidth;f["line-height"]="Opera"==window.navigator.appName?f.height-2*d["border-width"]+ "px":f.height+"px";for(j in d)f[j]=d[j];if(void 0!==i){var a;options={width:5,height:5};for(a in i)void 0!==options[a]&&(f[a]=parseInt(f[a],10)+i[a]*options[a]+"px")}j=new q(f,h,g,i);l[h.attr("id")]=j;h.css("display","none");j.div.insertBefore(h)}});return this};e.scrollbar=function(g){function i(d,c,h){d=d.height();scrollcontent_h=c.height();scrollbar_wrap_h=d-0.02*d;diff1=scrollcontent_h-d;prop=diff1/scrollcontent_h;scroll_area=scrollbar_wrap_h-2*b.btnsWidth;stopScroll=Math.floor(scroll_area*prop); size_slider=scrollbar_wrap_h-2*b.btnsWidth-stopScroll-2*b.bordersWidth;multiple=diff1/(scrollbar_wrap_h-2*b.btnsWidth-size_slider);multiple=scrollcontent_h/scroll_area;percentContent=diff1/100;percentSlider=stopScroll/100;void 0!=h&&(size_slider=height2,h.height(height2));return{scrollpane_h:d,scrollcontent_h:scrollcontent_h,scrollcontent_stop:d-scrollcontent_h,scrollbar_wrap_h:scrollbar_wrap_h,size_slider:size_slider,multiple:multiple,stopScroll:stopScroll,percentContent:percentContent,percentSlider:percentSlider}} function d(d){var c=this,h;this.scrollpane=d.scrollpane;this.scrollcontent=d.scrollcontent;this.params=i(this.scrollpane,this.scrollcontent);this.scroll_top=e("<div>").addClass("w-srcoll-top w-srcoll-btn").css({width:b.btnsWidth+"px",height:b.btnsWidth+"px",backgroundPosition:+(b.btnsWidth-14)/2+"px "+(b.btnsWidth-14)/2+"px "});this.scroll_bottom=e("<div>").addClass("w-srcoll-bottom w-srcoll-btn").css({width:b.btnsWidth+"px",height:b.btnsWidth+"px",backgroundPosition:+(b.btnsWidth-14)/2+"px 112%"}); this.scrollbar_wrap=e("<div>").addClass("w-srcollbar-wrap").css({height:this.params.scrollbar_wrap_h,width:b.btnsWidth});this.scrollbar=e("<div>").addClass("w-srcollbar").css({position:"relative",height:this.params.scrollbar_wrap_h-2*b.btnsWidth,top:b.btnsWidth+"px",width:b.btnsWidth+"px"});this.slider=e("<div>").addClass("w-slider").css({top:0,width:b.btnsWidth-2+"px",height:this.params.size_slider+"px"}).append("<span style='margin:"+this.params.size_slider/2+"px auto;'></span>");this.scrollbar_wrap.append(this.scroll_top); this.scrollbar_wrap.append(this.scrollbar);this.scrollbar_wrap.append(this.scroll_bottom);this.scrollbar.append(this.slider);this.scrollbar_wrap.appendTo(this.scrollpane);var g=function(){m.unbind("mousemove",j)},j=function(b){b.preventDefault();if(1>f+b.clientY-a)return c.slider.css({top:0}),c.scrollcontent.css({"margin-top":0}),!1;if(f+b.clientY-a>c.params.stopScroll-1)return c.slider.css({top:c.params.stopScroll}),c.scrollcontent.css({"margin-top":c.params.scrollcontent_stop+"px"}),!1;c.slider.css({top:f+ b.clientY-a+"px"});c.scrollcontent.css({"margin-top":c.params.multiple*-1*(f+b.clientY-a)+"px"})},f,a;c.slider.mousedown(function(b){b.preventDefault();m.bind("mousemove",j);m.one("mouseup",g);f=parseInt(c.slider.css("top"));a=b.clientY});this.scrollbar_wrap.click(function(a){a.stopPropagation()});this.scroll_top.add(this.scroll_bottom).bind({mousedown:function(a){var b;a.target==c.scroll_top[0]?(b=-1,stop=0):(b=1,stop=c.params.stopScroll);h=setInterval(function(){var a=parseInt(c.slider.css("top")); a==stop?(clearInterval(h),c.slider.css("top",stop+"px")):(c.slider.css("top",a+b+"px"),c.scrollcontent.css("margin-top",-1*c.params.multiple*(a+b)+"px"))},4)},mouseup:function(){clearInterval(h)}});this.scrollbar.bind("click",function(a){if(a.target!=c.scrollbar[0])return!1;var a=a.pageY,b=c.slider.offset().top,d=parseInt(c.scrollcontent.css("margin-top")),e,g=0,f;a<b?(e=a-b,f=-1*Math.round(2*(c.params.scrollcontent_h/c.params.scrollpane_h))):(e=a-b-c.params.size_slider,f=1*Math.round(2*(c.params.scrollcontent_h/ c.params.scrollpane_h)));h=setInterval(function(){if(g+f>=e&&0<f||g+f<=e&&0>f)return clearInterval(h),c.slider.offset({top:b+e}),c.scrollcontent.css("margin-top",d-c.params.multiple*e+"px"),!1;c.slider.offset({top:c.slider.offset().top+f});c.scrollcontent.css("margin-top",parseInt(c.scrollcontent.css("margin-top"))-f*c.params.multiple+"px");g+=f},1)})}var b={btnsWidth:16,btnsHeight:16,bordersWidth:1};d.prototype.move=function(b,c){var d,e=this.params;d=b<e.scrollpane_h-e.scrollcontent_h?e.scrollpane_h- e.scrollcontent_h:b;e=Math.abs(d)/e.percentContent*e.percentSlider;this.slider.css("top",e+"px");void 0==c?this.scrollcontent.animate({"margin-top":d+"px"},800):this.scrollcontent.css({"margin-top":!0===c?b:d+"px"})};d.prototype.show=function(){this.scrollbar_wrap.css("display","block")};d.prototype.hide=function(){this.scrollbar_wrap.css("display","none")};d.prototype.renew=function(){i(this.scrollpane,this.scrollcontent,this.slider)};return new d(g)}})(window.jQuery);
